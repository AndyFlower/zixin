## 工厂模式

### 一、简单工厂模式

#### 1.看一个具体的需要

有一个生产披萨的需求，要便于披萨种类的扩展，要便于维护

- 披萨种类很多
- 只做步骤分为prepare bake cut box
- 完成披萨的定个功能

#### 2.使用传统的方式来完成

##### 2.1思路分析

![image-20200817125920947](.\images\image-20200817125920947.png)

##### 2.2代码

```java
package com.slp.pattern.factory.v1;

/**
 * @ClassName Pizza
 * @Description TODO
 * @Author sanglp
 * @Date 2020/8/17 13:00
 * @Version 1.0
 **/
public abstract class Pizza {
    private String name;
    public abstract void prepare();
    public  void bake(){
        System.out.println(name+" bake");
    }
    public  void cut(){
        System.out.println(name+" cut");
    }
    public  void box(){
        System.out.println(name+" box");
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}

package com.slp.pattern.factory.v1;

/**
 * @ClassName GreekPizza
 * @Description TODO
 * @Author sanglp
 * @Date 2020/8/17 13:02
 * @Version 1.0
 **/
public class GreekPizza extends Pizza {
    @Override
    public void prepare() {
        System.out.println("prepare GreekPizza");
    }

}


package com.slp.pattern.factory.v1;

/**
 * @ClassName ChinaPizza
 * @Description TODO
 * @Author sanglp
 * @Date 2020/8/17 13:02
 * @Version 1.0
 **/
public class ChinaPizza extends Pizza {
    @Override
    public void prepare() {
        System.out.println("prepare ChinaPizza");
    }


}


package com.slp.pattern.factory.v1;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Scanner;

/**
 * @ClassName OrderPizza
 * @Description TODO
 * @Author sanglp
 * @Date 2020/8/17 12:58
 * @Version 1.0
 **/
public class OrderPizza {
    public static void main(String[] args) {
        OrderPizza orderPizza = new OrderPizza();
    }
    public OrderPizza(){
        Pizza pizza = null;
        String orderType ;//订购的类型
        do{
            orderType=getType();
            if(orderType.equals("greek")){
                pizza = new GreekPizza();
                pizza.setName("希腊披萨");
            }else if(orderType.equals("china")){
                pizza = new ChinaPizza();
                pizza.setName("中国披萨");
            }else {

                break;
            }
            pizza.prepare();
            pizza.bake();
            pizza.cut();
            pizza.box();

        }while (true);
    }

    /**
     * pizza种类从控制台输入
     * @return
     */
    private String getType() {
        BufferedReader s = new BufferedReader(new InputStreamReader(System.in));
        String str = null;
        try {
            str = s.readLine();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return str;
    }
}

```

##### 2.3  传统方式的优缺点

- 优点是比较好理解，简单易操作
- 缺点是违反了设计模式的ocp原则，及对扩展开发，对修改关闭。即当我们给类增加新功能的时候，尽量不修改代码，或者是少修改代码。
- 比如我们此时需要新增加一个种类，那么orderPizza中需要新增分支

##### 2.4 改进思路

修改代码可以接受，但是如果我们在其他的地方也有创建的代码 ，就意味着，也需要修改，而创建pizza的代码，往往会有很多。也就是说有很多类都在调用这个方法。

这样的话，我们可以将创建pizza对象封装到一个类中，这样我们有新的pizza种类的时候，只需要修改该类即可，这样其他创建到pizza对的diam就不需要修改了

这也就是简单工厂模式

#### 3.简单工厂模式基本介绍

简单工厂模式属于创建型模式，是工厂模式的一种，简单工厂模式是由一个工厂对象决定创建出哪一种产品类的实例，简单工厂模式是工厂模式中最简单实用的模式。

简单工厂模式：定义了一个创建对象的类，由这个类来封装实例化对象的行为

在软件开发中，当我们会用到大量的创建某种、某类或某批对象时，就会使用到工厂模式。

##### 3.1 使用简单工厂模式

- 定义一个可以实例化Pizza对象的类，封装创建对象的代码

![image-20200817135352458](.\images\image-20200817135352458.png)

- 示例代码

```java
package com.slp.pattern.factory.v2;

/**
 * @ClassName SimpleFactory
 * @Description 简单工厂模式
 * @Author sanglp
 * @Date 2020/8/17 13:56
 * @Version 1.0
 **/
public class SimpleFactory {
    public Pizza createPizza(String orderType){
        Pizza pizza = null;
        if(orderType.equals("greek")){
            pizza = new GreekPizza();
            pizza.setName("希腊披萨");
        }else if(orderType.equals("china")){
            pizza = new ChinaPizza();
            pizza.setName("中国披萨");
        }else {

            System.out.println("输入有误");
        }
       return pizza;

    }

    /**
     * 简单工厂模式，也叫静态工厂模式
     * @param orderType
     * @return
     */
    public static Pizza createPizzav2(String orderType){
        Pizza pizza = null;
        System.out.println("使用简单工厂模式2");
        if(orderType.equals("greek")){
            pizza = new GreekPizza();
            pizza.setName("希腊披萨");
        }else if(orderType.equals("china")){
            pizza = new ChinaPizza();
            pizza.setName("中国披萨");
        }else {

            System.out.println("输入有误");
        }
        return pizza;
    }
}

package com.slp.pattern.factory.v2;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

/**
 * @ClassName OrderPizza
 * @Description TODO
 * @Author sanglp
 * @Date 2020/8/17 14:01
 * @Version 1.0
 **/
public class OrderPizza {
    //定义一个简单工厂
    SimpleFactory simpleFactory;
    Pizza pizza = null;
    //构造器
    public  OrderPizza(SimpleFactory simpleFactory){
        setFactory(simpleFactory);
    }

    public void setFactory(SimpleFactory simpleFactory){
        String orderType = "";
        this.simpleFactory = simpleFactory;//设置简单工厂对象
        do{
            orderType = getType();
            pizza = this.simpleFactory.createPizza(orderType);
            if(pizza!=null) {
                pizza.prepare();
                pizza.bake();
                pizza.cut();
                pizza.box();
            }else {
                System.out.println("订购失败");
            }
        }while (true);
    }
    /**
     * pizza种类从控制台输入
     * @return
     */
    private String getType() {
        BufferedReader s = new BufferedReader(new InputStreamReader(System.in));
        String str = null;
        try {
            str = s.readLine();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return str;
    }
}

```

### 二、工厂方法模式

#### 1.看一个新的需求

还是上面的案例，但是现在客户在点pizza的时候可以点不同口味的披萨，比如北京的奶酪pizza,北京的胡椒pizza或者伦敦的奶酪pizza，伦敦的胡椒pizza

#### 2.思路一

使用简单工厂模式，创建不同的简单工厂类，比如BJPizzaSimpleFactory.LDPizzaSimpleFactory等等，从当前这个案例来说，也是可以的。但是考虑更久远一些的话其实并不太好。

#### 3.思路二

使用工厂方法模式

#### 4.工厂方法模式介绍

- 工厂方法模式设计方案：将披萨项目的实例化功能抽象成抽象方法，在不同的口味点餐子类中具体实现
- 工厂方法模式：定义了一个创建对象的抽象方法，由子类决定要实例化的类，工厂方法模式将对象的实例推迟到子类

#### 5.工厂方法模式应用案例

![image-20200817163324078](.\images\image-20200817163324078.png)



